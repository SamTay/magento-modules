<?xml version="1.0"?>
<!--/*
 * @package     BlueAcorn\ShipmentIntegration
 * @version     0.2.0
 * @author      Sam Tay @ Blue Acorn, Inc. <code@blueacorn.com>
 * @copyright   Copyright Â© 2016 Blue Acorn, Inc.
 */-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework-message-queue:etc/queue.xsd">
    <!-- Might only need one route for create & update -->

    <!-- Publishers & Topics -->
    <publisher name="shipments" connection="amqp" exchange="shipments"/>
    <topic publisher="shipments" name="erp.shipment.create" schema="BlueAcorn\ShipmentIntegration\Api\ImportInterface::create" />
    <topic publisher="shipments" name="erp.shipment.update" schema="BlueAcorn\ShipmentIntegration\Api\ImportInterface::update" />

    <!-- Consumers & Bindings -->
    <consumer name="shipmentCreatedListener" queue="shipment_create_queue" connection="amqp" class="BlueAcorn\ShipmentIntegration\Api\ImportInterface" method="create" max_messages="100"/>
    <consumer name="shipmentUpdatedListener" queue="shipment_update_queue" connection="amqp" class="BlueAcorn\ShipmentIntegration\Api\ImportInterface" method="update" max_messages="100"/>
    <bind queue="shipment_create_queue" exchange="shipments" topic="external.shipment.create" />
    <bind queue="shipment_update_queue" exchange="shipments" topic="external.shipment.update" />
</config>
